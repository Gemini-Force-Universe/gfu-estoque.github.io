import{B as ce,m as le,h as g,c as y,D as X,d as me,s as p,t as ve,v as pe,x as fe,a as i,b as o,y as O,w as s,n as P,e as t,F as be,f as ge,z as j,i as B,p as C,E as Z,A as W,C as ee,q as E}from"./index-2J9sCafD.js";import{s as h,a as L}from"./index-DUadEqb7.js";import{j as ye,a as xe,b as he,c as z,d as we,e as U,f as M,g as F,h as ke}from"./index-DYiP9Fvw.js";var Ve=function(u){var l=u.dt;return`
.p-textarea {
    font-family: inherit;
    font-feature-settings: inherit;
    font-size: 1rem;
    color: `.concat(l("textarea.color"),`;
    background: `).concat(l("textarea.background"),`;
    padding-block: `).concat(l("textarea.padding.y"),`;
    padding-inline: `).concat(l("textarea.padding.x"),`;
    border: 1px solid `).concat(l("textarea.border.color"),`;
    transition: background `).concat(l("textarea.transition.duration"),", color ").concat(l("textarea.transition.duration"),", border-color ").concat(l("textarea.transition.duration"),", outline-color ").concat(l("textarea.transition.duration"),", box-shadow ").concat(l("textarea.transition.duration"),`;
    appearance: none;
    border-radius: `).concat(l("textarea.border.radius"),`;
    outline-color: transparent;
    box-shadow: `).concat(l("textarea.shadow"),`;
}

.p-textarea:enabled:hover {
    border-color: `).concat(l("textarea.hover.border.color"),`;
}

.p-textarea:enabled:focus {
    border-color: `).concat(l("textarea.focus.border.color"),`;
    box-shadow: `).concat(l("textarea.focus.ring.shadow"),`;
    outline: `).concat(l("textarea.focus.ring.width")," ").concat(l("textarea.focus.ring.style")," ").concat(l("textarea.focus.ring.color"),`;
    outline-offset: `).concat(l("textarea.focus.ring.offset"),`;
}

.p-textarea.p-invalid {
    border-color: `).concat(l("textarea.invalid.border.color"),`;
}

.p-textarea.p-variant-filled {
    background: `).concat(l("textarea.filled.background"),`;
}

.p-textarea.p-variant-filled:enabled:focus {
    background: `).concat(l("textarea.filled.focus.background"),`;
}

.p-textarea:disabled {
    opacity: 1;
    background: `).concat(l("textarea.disabled.background"),`;
    color: `).concat(l("textarea.disabled.color"),`;
}

.p-textarea::placeholder {
    color: `).concat(l("textarea.placeholder.color"),`;
}

.p-textarea.p-invalid::placeholder {
    color: `).concat(l("textarea.invalid.placeholder.color"),`;
}

.p-textarea-fluid {
    width: 100%;
}

.p-textarea-resizable {
    overflow: hidden;
    resize: none;
}

.p-textarea-sm {
    font-size: `).concat(l("textarea.sm.font.size"),`;
    padding-block: `).concat(l("textarea.sm.padding.y"),`;
    padding-inline: `).concat(l("textarea.sm.padding.x"),`;
}

.p-textarea-lg {
    font-size: `).concat(l("textarea.lg.font.size"),`;
    padding-block: `).concat(l("textarea.lg.padding.y"),`;
    padding-inline: `).concat(l("textarea.lg.padding.x"),`;
}
`)},Ie={root:function(u){var l=u.instance,c=u.props;return["p-textarea p-component",{"p-filled":l.$filled,"p-textarea-resizable ":c.autoResize,"p-textarea-sm p-inputfield-sm":c.size==="small","p-textarea-lg p-inputfield-lg":c.size==="large","p-invalid":l.$invalid,"p-variant-filled":l.$variant==="filled","p-textarea-fluid":l.$fluid}]}},$e=ce.extend({name:"textarea",theme:Ve,classes:Ie}),Ce={name:"BaseTextarea",extends:ye,props:{autoResize:Boolean},style:$e,provide:function(){return{$pcTextarea:this,$parentInstance:this}}},H={name:"Textarea",extends:Ce,inheritAttrs:!1,observer:null,mounted:function(){var u=this;this.autoResize&&(this.observer=new ResizeObserver(function(){u.resize()}),this.observer.observe(this.$el))},updated:function(){this.autoResize&&this.resize()},beforeUnmount:function(){this.observer&&this.observer.disconnect()},methods:{resize:function(){this.$el.offsetParent&&(this.$el.style.height="auto",this.$el.style.height=this.$el.scrollHeight+"px",parseFloat(this.$el.style.height)>=parseFloat(this.$el.style.maxHeight)?(this.$el.style.overflowY="scroll",this.$el.style.height=this.$el.style.maxHeight):this.$el.style.overflow="hidden")},onInput:function(u){this.autoResize&&this.resize(),this.writeValue(u.target.value,u)}},computed:{attrs:function(){return le(this.ptmi("root",{context:{filled:this.$filled,disabled:this.disabled}}),this.formField)}}},ze=["value","disabled","aria-invalid"];function Ue(d,u,l,c,f,v){return g(),y("textarea",le({class:d.cx("root"),value:d.d_value,disabled:d.disabled,"aria-invalid":d.invalid||void 0,onInput:u[0]||(u[0]=function(){return v.onInput&&v.onInput.apply(v,arguments)})},v.attrs),null,16,ze)}H.render=Ue;typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const ae=()=>{};function Re(d,u){function l(...c){return new Promise((f,v)=>{Promise.resolve(d(()=>u.apply(this,c),{fn:u,thisArg:this,args:c})).then(f).catch(v)})}return l}function _e(d,u={}){let l,c,f=ae;const v=b=>{clearTimeout(b),f(),f=ae};return b=>{const N=X(d),w=X(u.maxWait);return l&&v(l),N<=0||w!==void 0&&w<=0?(c&&(v(c),c=null),Promise.resolve(b())):new Promise((V,R)=>{f=u.rejectOnCancel?R:V,w&&!c&&(c=setTimeout(()=>{l&&v(l),c=null,V(b())},w)),l=setTimeout(()=>{c&&v(c),c=null,V(b())},N)})}}function Se(d,u=200,l={}){return Re(_e(u,l),d)}const Ee={class:"flex justify-between gap-4 p-2"},Fe=["src"],Ne=["title"],Te={class:"flex items-center justify-center w-full"},De={class:"flex items-center justify-center w-full"},qe={key:0,class:"flex items-center justify-center w-full aspect-square"},Ae={key:1,class:"flex flex-col gap-6"},je={key:0,class:"text-red-500"},Le={key:0,class:"text-red-500"},Me={class:"flex items-center gap-2"},Oe={key:0,class:"text-red-500"},Pe={class:"flex gap-4"},Be={class:"mt-6"},We={key:0,class:"flex items-center justify-center w-full aspect-square"},He={key:1,class:"flex flex-col gap-6"},Ge={key:0,class:"text-red-500"},Ke={key:0,class:"text-red-500"},Qe={class:"flex items-center gap-2"},Ye={key:0,class:"text-red-500"},Je={class:"mt-6"},aa=me({__name:"ItemsView",setup(d){const u=[{label:"Equipamento",value:"equipamento"},{label:"Poder",value:"poder"},{label:"Especialização",value:"especializacao"},{label:"Consumível",value:"consumivel"},{label:"Veículo",value:"veiculo"},{label:"Origem",value:"origem"}],l=[{label:"Comum",value:"comum"},{label:"Incomum",value:"incomum"},{label:"Raro",value:"raro"},{label:"Especial",value:"especial"},{label:"Único",value:"unico"}],c={global:{value:null,matchMode:W.CONTAINS},name:{operator:ee.AND,constraints:[{value:null,matchMode:W.STARTS_WITH}]},category:{operator:ee.AND,constraints:[{value:null,matchMode:W.EQUALS}]}},f=p([]),v=p([]),k=p(c),b=p(0),N=p(["id","name","category"]),w=p(!1),V=p(10),R=p(0),x=p(""),_=p(!1),T=p(!1),n=p({name:"",description:"",category:"equipamento",rarity:"comum",image_url:"",submitted:!1}),D=p(!1),q=p(!1),r=p({id:-1,name:"",description:"",category:"",rarity:"",image_url:"",submitted:!1}),G=ve(()=>x.value!==""),A=p(!1),K=p(""),$=p(null),S=async()=>{w.value=!0,v.value=[];const e=await E().items.getPagedItems({page:b.value/V.value+1,size:V.value});return w.value=!1,e.success?(R.value=e.total,e.result):(console.error("Failed to fetch items",e.message),[])},te=Se(async()=>{if(k.value.global.value===null||k.value.global.value===""){S();return}console.log("Searching items..."),w.value=!0,f.value=[];const e=await E().items.searchItems({name:k.value.global.value});if(w.value=!1,!e.success)return console.error("Failed to search items",e.message),[];v.value=e.result,R.value=e.result.length,console.log("Done searching items"),v.value.length>0&&(b.value=v.value[0].id)},700),Q=()=>{k.value=c},ie=()=>{T.value=!0},Y=()=>{T.value=!1,n.value={name:"",description:"",category:"equipamento",rarity:"comum",image_url:"",submitted:!1}},oe=async()=>{if(n.value.submitted=!0,!n.value.name||!n.value.description||!n.value.category||!n.value.image_url)return;_.value=!0;const m=E();try{const e=await m.items.createItem({name:n.value.name,description:n.value.description,category:n.value.category,rarity:n.value.rarity,image_url:n.value.image_url});!e.success||!e.id?(console.error("Failed to create item",e.message),x.value=`Erro ao criar item: ${e.message}`):(x.value="Item criado com sucesso!",f.value=await S())}catch(e){console.error("Failed to create item",e),_.value=!1,x.value=`Erro interno ao criar item: ${e==null?void 0:e.toString()}`;return}Y(),_.value=!1,n.value={name:"",description:"",category:"equipamento",rarity:"comum",image_url:"",submitted:!1}},ne=m=>{r.value={id:m.id,name:m.name,description:m.description,category:m.category,rarity:m.rarity,image_url:m.image_url,submitted:!1},q.value=!0},J=()=>{q.value=!1,r.value={id:-1,name:"",description:"",category:"",rarity:"",image_url:"",submitted:!1}},re=async()=>{if(r.value.submitted=!0,!r.value.name||!r.value.description||!r.value.category||!r.value.image_url)return;D.value=!0;const m=E();try{const e=await m.items.updateItem({id:r.value.id,name:r.value.name,description:r.value.description,category:r.value.category,rarity:r.value.rarity,image_url:r.value.image_url});e.success?(x.value="Item salvo com sucesso!",f.value=await S()):(console.error("Failed to update item",e.message),x.value=`Erro ao salvar item: ${e.message}`)}catch(e){console.error("Failed to update item",e),x.value=`Erro interno ao salvar item: ${e==null?void 0:e.toString()}`}J(),D.value=!1,r.value={id:-1,name:"",description:"",category:"",rarity:"",image_url:"",submitted:!1}},se=async m=>{if(K.value=`Deseja excluir o item "${m.name}"?`,A.value=!0,await new Promise(e=>{const a=setInterval(()=>{$.value!==null&&(clearInterval(a),e())},100)}),A.value=!1,!$.value){$.value=null;return}$.value=null;try{await E().items.removeItem(m.id),x.value="Item excluído com sucesso!",f.value=await S()}catch(e){console.error("Failed to delete item",e==null?void 0:e.toString()),x.value=`Erro ao excluir item: ${e==null?void 0:e.toString()}`}},ue=m=>{const e=u.find(a=>a.value===m);return e?e.label:"???"},de=m=>{const e=l.find(a=>a.value===m);return e?e.label:"???"};return pe(()=>{Q()}),fe([b,V],async()=>{if(v.value.length>0){f.value=v.value.slice(b.value,b.value+V.value);return}console.log("Fetching items..."),f.value=await S(),console.log("Done fetching items")},{immediate:!0}),(m,e)=>(g(),y(be,null,[i("div",{class:P(t(B)(`
        flex flex-col items-center justify-center
        size-full
      `))},[o(t(ke),{value:f.value,size:"small","data-key":"id","filter-display":"menu","global-filter-fields":N.value,"sort-field":"id","sort-order":1,"table-class":"min-w-[60rem]",class:P(t(B)(`
          p-8
          rounded-xl
          bg-[#18181b]
        `)),filters:k.value,"onUpdate:filters":e[3]||(e[3]=a=>k.value=a)},O({header:s(()=>[i("div",Ee,[o(t(h),{label:"Novo Item",icon:"pi pi-plus",onClick:ie}),o(t(h),{class:"mr-auto",type:"button",icon:"pi pi-filter-slash",label:"Limpar filtros",outlined:"",onClick:e[0]||(e[0]=a=>Q())}),o(t(xe),{class:"ml-auto"},{default:s(()=>[o(t(he),null,{default:s(()=>e[20]||(e[20]=[i("i",{class:"pi pi-search"},null,-1)])),_:1}),o(t(z),{placeholder:"Pesquisar",modelValue:k.value.global.value,"onUpdate:modelValue":e[1]||(e[1]=a=>k.value.global.value=a),onKeyup:t(te)},null,8,["modelValue","onKeyup"])]),_:1})])]),footer:s(()=>[o(t(we),{rows:V.value,totalRecords:R.value,first:b.value,"onUpdate:first":e[2]||(e[2]=a=>b.value=a)},null,8,["rows","totalRecords","first"])]),default:s(()=>[o(t(U),{field:"image_url",header:"Imagem"},{body:s(({data:a})=>[i("img",{src:a.image_url,alt:"Imagem",class:"w-12 h-12 object-contain"},null,8,Fe)]),_:1}),o(t(U),{field:"name",header:"Nome",sortable:""},{body:s(({data:a})=>[ge(j(a.name),1)]),filter:s(({filterModel:a})=>[o(t(z),{type:"text",placeholder:"...",modelValue:a.value,"onUpdate:modelValue":I=>a.value=I},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),o(t(U),{field:"description",header:"Descrição"},{body:s(({data:a})=>[i("span",{title:a.description},j(a.description.length>30?a.description.slice(0,30)+"...":a.description),9,Ne)]),_:1}),o(t(U),{field:"category",header:"Categoria",sortable:""},{body:s(({data:a})=>[o(t(M),{value:ue(a.category),severity:"contrast"},null,8,["value"])]),filter:s(({filterModel:a})=>[o(t(F),{options:u,placeholder:"Selecione uma","option-label":"label","option-value":"value","show-clear":"",modelValue:a.value,"onUpdate:modelValue":I=>a.value=I},{option:s(I=>[o(t(M),{value:I.option.label,severity:"contrast"},null,8,["value"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),o(t(U),{field:"rarity",header:"Raridade",sortable:""},{body:s(({data:a})=>[o(t(M),{value:de(a.rarity),severity:"contrast"},null,8,["value"])]),filter:s(({filterModel:a})=>[o(t(F),{options:l,placeholder:"Selecione uma","option-label":"label","option-value":"value","show-clear":"",modelValue:a.value,"onUpdate:modelValue":I=>a.value=I},{option:s(I=>[o(t(M),{value:I.option.label,severity:"contrast"},null,8,["value"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),o(t(U),{class:"max-w-52"},{body:s(({data:a})=>[i("div",{class:P(t(B)(`
                flex items-center justify-end
                gap-3
                h-12
              `))},[o(t(h),{type:"button",size:"small",severity:"primary",icon:"pi pi-pencil",label:"Editar",raised:"",onClick:()=>ne(a)},null,8,["onClick"]),o(t(h),{type:"button",size:"small",severity:"danger",icon:"pi pi-trash",label:"Excluir",raised:"",onClick:()=>se(a)},null,8,["onClick"])],2)]),_:1})]),_:2},[w.value?{name:"empty",fn:s(()=>[e[21]||(e[21]=i("div",{class:"flex items-center justify-center gap-2 p-3"},[i("i",{class:"pi pi-spin pi-spinner"}),i("i",null,"Carregando dados...")],-1))]),key:"0"}:{name:"empty",fn:s(()=>[e[22]||(e[22]=i("div",{class:"flex items-center justify-center p-3"},[i("i",null,"Nenhum item encontrado.")],-1))]),key:"1"}]),1032,["value","global-filter-fields","class","filters"])],2),o(t(L),{class:"w-[450px]",header:"Aviso",closable:!1,modal:!0,visible:G.value,"onUpdate:visible":e[5]||(e[5]=a=>G.value=a)},{footer:s(()=>[o(t(h),{label:"OK",icon:"pi pi-check",onClick:e[4]||(e[4]=a=>x.value="")})]),default:s(()=>[i("div",Te,[i("span",null,j(x.value),1)])]),_:1},8,["visible"]),o(t(L),{class:"w-[450px]",header:"Confirmação",closable:!1,modal:!0,visible:A.value,"onUpdate:visible":e[8]||(e[8]=a=>A.value=a)},{footer:s(()=>[o(t(h),{label:"Sim",icon:"pi pi-check",onClick:e[6]||(e[6]=a=>$.value=!0)}),o(t(h),{label:"Não",icon:"pi pi-times",text:"",onClick:e[7]||(e[7]=a=>$.value=!1)})]),default:s(()=>[i("div",De,[i("span",null,j(K.value),1)])]),_:1},8,["visible"]),o(t(L),{class:"w-[450px]",header:"Criar um Novo Item",closable:!1,modal:!0,visible:T.value,"onUpdate:visible":e[14]||(e[14]=a=>T.value=a)},O({default:s(()=>[_.value?(g(),y("div",qe,e[23]||(e[23]=[i("i",{class:"pi pi-spin pi-spinner"},null,-1)]))):(g(),y("div",Ae,[i("div",null,[e[24]||(e[24]=i("label",{for:"name",class:"block font-bold mb-3"},"Nome",-1)),o(t(z),{id:"name",required:!0,autofocus:"",invalid:n.value.submitted&&!n.value.name,modelValue:n.value.name,"onUpdate:modelValue":e[9]||(e[9]=a=>n.value.name=a),modelModifiers:{trim:!0},fluid:""},null,8,["invalid","modelValue"]),n.value.submitted&&!n.value.name?(g(),y("small",je," O nome é obrigatório. ")):C("",!0)]),i("div",null,[e[25]||(e[25]=i("label",{for:"description",class:"block font-bold mb-3"}," Descrição ",-1)),o(t(H),{id:"description",required:!0,autofocus:"",invalid:n.value.submitted&&!n.value.description,modelValue:n.value.description,"onUpdate:modelValue":e[10]||(e[10]=a=>n.value.description=a),modelModifiers:{trim:!0},fluid:""},null,8,["invalid","modelValue"]),n.value.submitted&&!n.value.description?(g(),y("small",Le," A descrição é obrigatória. ")):C("",!0)]),i("div",null,[e[26]||(e[26]=i("label",{for:"image_url",class:"block font-bold mb-3"}," URL da Imagem ",-1)),i("div",Me,[o(t(z),{id:"image_url",required:!0,autofocus:"",invalid:n.value.submitted&&!n.value.image_url,modelValue:n.value.image_url,"onUpdate:modelValue":e[11]||(e[11]=a=>n.value.image_url=a),modelModifiers:{trim:!0},fluid:""},null,8,["invalid","modelValue"]),i("div",{class:"flex-shrink-0 w-12 h-12 bg-center bg-contain bg-no-repeat",style:Z({"background-image":`url(${n.value.image_url})`})},null,4)]),n.value.submitted&&!n.value.image_url?(g(),y("small",Oe," O URL da imagem é obrigatório. ")):C("",!0)]),i("div",Pe,[i("div",null,[e[27]||(e[27]=i("label",{for:"category",class:"block font-bold mb-3"},"Categoria",-1)),o(t(F),{id:"category",name:"category",options:u,"option-label":"label","option-value":"value",modelValue:n.value.category,"onUpdate:modelValue":e[12]||(e[12]=a=>n.value.category=a)},null,8,["modelValue"])]),i("div",null,[e[28]||(e[28]=i("label",{for:"category",class:"block font-bold mb-3"},"Raridade",-1)),o(t(F),{id:"rarity",name:"rarity",options:l,"option-label":"label","option-value":"value",modelValue:n.value.rarity,"onUpdate:modelValue":e[13]||(e[13]=a=>n.value.rarity=a)},null,8,["modelValue"])])])]))]),_:2},[_.value?void 0:{name:"footer",fn:s(()=>[i("div",Be,[o(t(h),{label:"Salvar",icon:"pi pi-check",onClick:oe}),o(t(h),{label:"Cancelar",icon:"pi pi-times",text:"",onClick:Y})])]),key:"0"}]),1032,["visible"]),o(t(L),{class:"w-[450px]",header:"Editar Item",closable:!1,modal:!0,visible:q.value,"onUpdate:visible":e[19]||(e[19]=a=>q.value=a)},O({default:s(()=>[D.value?(g(),y("div",We,e[29]||(e[29]=[i("i",{class:"pi pi-spin pi-spinner"},null,-1)]))):(g(),y("div",He,[i("div",null,[e[30]||(e[30]=i("label",{for:"name",class:"block font-bold mb-3"},"Nome",-1)),o(t(z),{id:"name",required:!0,autofocus:"",invalid:r.value.submitted&&!r.value.name,modelValue:r.value.name,"onUpdate:modelValue":e[15]||(e[15]=a=>r.value.name=a),modelModifiers:{trim:!0},fluid:""},null,8,["invalid","modelValue"]),r.value.submitted&&!r.value.name?(g(),y("small",Ge," O nome é obrigatório. ")):C("",!0)]),i("div",null,[e[31]||(e[31]=i("label",{for:"description",class:"block font-bold mb-3"}," Descrição ",-1)),o(t(H),{id:"description",required:!0,autofocus:"",invalid:r.value.submitted&&!r.value.description,modelValue:r.value.description,"onUpdate:modelValue":e[16]||(e[16]=a=>r.value.description=a),modelModifiers:{trim:!0},fluid:""},null,8,["invalid","modelValue"]),r.value.submitted&&!r.value.description?(g(),y("small",Ke," A descrição é obrigatória. ")):C("",!0)]),i("div",null,[e[32]||(e[32]=i("label",{for:"image_url",class:"block font-bold mb-3"}," URL da Imagem ",-1)),i("div",Qe,[o(t(z),{id:"image_url",required:!0,autofocus:"",invalid:r.value.submitted&&!r.value.image_url,modelValue:r.value.image_url,"onUpdate:modelValue":e[17]||(e[17]=a=>r.value.image_url=a),modelModifiers:{trim:!0},fluid:""},null,8,["invalid","modelValue"]),i("div",{class:"flex-shrink-0 w-12 h-12 bg-center bg-contain bg-no-repeat",style:Z({"background-image":`url(${r.value.image_url})`})},null,4)]),r.value.submitted&&!r.value.image_url?(g(),y("small",Ye," O URL da imagem é obrigatório. ")):C("",!0)]),i("div",null,[e[33]||(e[33]=i("label",{for:"category",class:"block font-bold mb-3"},"Categoria",-1)),o(t(F),{id:"category",name:"category",options:u,"option-label":"label","option-value":"value",modelValue:r.value.category,"onUpdate:modelValue":e[18]||(e[18]=a=>r.value.category=a)},null,8,["modelValue"])])]))]),_:2},[D.value?void 0:{name:"footer",fn:s(()=>[i("div",Je,[o(t(h),{label:"Salvar",icon:"pi pi-check",onClick:re}),o(t(h),{label:"Cancelar",icon:"pi pi-times",text:"",onClick:J})])]),key:"0"}]),1032,["visible"])],64))}});export{aa as default};
